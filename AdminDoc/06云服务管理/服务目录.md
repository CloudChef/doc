**服务目录**
# 功能描述

服务目录的主要作用是为用户提供统一的云服务入口。将云资源的申请、运维、变更、监控和回收都服务化，并配套提供企业级的流程、权限和配额管控。
+ 提供在一个页面，申请任意云服务的能力，这样用户可以非常方便的以服务目录的形式，访问有权限的多种类型的阿里云服务、VMware云资源服务、容器云服务、工单服务、邮件服务等等。例如：Tomcat，MySQL集群，J2EE三层应用等。示例如下图：

![服务目录](../../picture/Admin/服务目录.png)

+ 其中，工单服务，即非标准化需要人工介入和支持的服务，包括服务请求，云资源出现问题时的事件处理，例如用户忘记密码需要进行重置，或是提交一个开通邮箱或账户的请求。
+ 服务目录项都是通过云管理平台的蓝图编排设计后进行相应的参数配置。服务既可以部署在私有云，也可以部署到公有云，还可以适用于越来越广泛地混合云部署，例如，前端应用部署在阿里云上，数据库部署在私有云上。  
+ 在服务目录中还可以定义服务分组，将这些服务分门别类的放置，方便服务的管理和查找。
+ 并且，服务目录可以是千人千面的，不同用户可以访问的服务可设置成不一样的，以打造面向用户、个性化、拥有多种云服务类型、统一的服务入口。

+ 在申请服务时，无论是申请阿里云的服务，还是VMware的资源，云平台提供了统一的类公有云服务体验，降低用户使用门槛，还能根据资源用量和价格，展示每个服务不同配置的整体服务费用。如下图所示：

![类公有云的体验01](../../picture/Admin/类公有云的体验01.png)

![类公有云的体验02](../../picture/Admin/类公有云的体验02.png)

# 服务目录展现方式
服务配置发布成功之后，将会在服务目录界面看到发布的服务卡片，服务目录的界面展示支持两种方式：
1. 标签页展示：即分组按照标签页展示，可以通过服务分组标签、业务组或搜索框快速定位您需要申请的服务。
2. 层级展示：按照卡片的模式，先展示分组（图标，名称，描述）--文件夹的显示方式，点击一个分组，再展现这个分组的所有卡片，对于没有分组的卡片，如果按照层级展示，增加一个 未分组的服务 文件夹，点击进入展现所有未分组的卡片。如果卡片都是有分组的，则这个文件夹不显示。

>「Note」 服务目录展现方式，在系统配置-界面配置功能区进行选择，具体操作步骤，请参考：[界面配置](https://cloudchef.github.io/doc/AdminDoc/09系统管理/#界面配置)

## 标签页展示{#服务目录申请}

当服务目录以标签页方式展示时，可以通过服务分组标签，例如：数据库、基础设施、工单服务等等，或通过不同的业务组，或通过搜索框快速定位您需要申请的服务。

以"在vSphere云平台上部署虚拟机"为例：

1.  在左侧导航栏点击「服务目录」，选择某 "vSphere VM" 服务，点击将进入服务申请页面

2.  服务申请页面的相关申请参数：

组织信息

 +  业务组	若该服务为全部业务组，即共享服务，需选择业务组（该业务组需有相关资源池，否则将不允许申请）；若服务配置时该服务已指定业务组，则无需填写
 +  项目	若该业务组下划分了项目，则可以选择项目
 +  所有者	选择该服务的所有者，所有者需为业务组成员，服务部署的所有者，在服务部署的运维操作中支持更新所有者

部署信息

 + 名称	若业务组已配置 “服务部署名命名规则”，则服务部署名无需填写，将根据业务组规则自动生成，若业务组未配置“服务部署名命名规则”，需手动填写
 + 数量	填写部署的数量，默认为1
 + 执行时间	可指定时间开始服务部署，精确到分钟
 + 键值标签	默认勾选，所有server节点使用相同的键值标签， 若不勾选，将列出该服务部署下的所有server节点，可为每个server节点单独设置键值标签

其他信息

 + 表单配置的参数	如果您在服务配置的表单配置中为云资源蓝图服务和手工单服务自定义相关字段，则在此处填写所需信息

申请参数

 + 申请参数	若服务配置时，仅仅勾选了 “允许改变”这一项（没有勾选“仅审批时可修改”）或 ，将出现申请参数栏，可根据需要配置相关Server、Network、等组件的详细参数
 + 软件配置	若在服务配置时勾选了“允许申请时添加软件”，将出现软件配置栏，可为该服务的计算节点/软件组件添加软件，点击「添加软件」	选择要安装的软件，将列出所有的软件组件；选择关系：“安装到”或“依赖于”；选择要安装到或依赖于的节点。


 填写完成后点击「申请」，将根据业务组流程控制直接部署或等待审批，可至「我的部署」-「服务部署」中查看部署情况（也可在右上角「操作历史」中查看部署情况），或至「服务请求」-「待审批」中查看审批流程。

 在您进行服务申请时，未能一次性填写完相关参数，点击「保存」能够对已填写参数进行保存，并且在下次申请的时候，点击「加载」可以重新加载，自动填充上次已经填写好的参数。

 在您进行服务申请时，提前配置计费规则（私有云和共有云不相同，见下文），平台可以显示此次申请的费用，计费规则的具体配置步骤：
 + 针对私有云，管理员在「计量计费」-「计费规则」配置私有云的计费规则之后，用户在申请服务时，直接使用计费的API进行计费。

 + 针对公有云需要缓存公有云的单价API结构，然后计算费用。




## 层级展示
+ 采用层级展示的方式，按照卡片的模式，先展示服务分组，服务分组的具体操作步骤，请参考：[服务分组](https://cloudchef.github.io/doc/AdminDoc/05服务建模/服务分组.html) 


+ 在服务目录视图界面，可查看服务分组的图标、名称、描述和文件夹的显示方式，点击一个分组，展现此服务分组的所有卡片。（注意：当管理员创建的服务卡片没有选择服务分组时，如果按照层级展示，此类型卡片会存入 “未分组的服务” 文件夹，点击进入展现所有未分组的卡片。如果管理员创建的服务卡片都是有分组的，则“未分组的服务” 文件夹不显示。）


# 选择蓝图进行云资源申请
SmartCMP支持一张服务卡片绑定多个蓝图，支持用户根据需求快速选择蓝图，例如："申请数据库"的服务卡片，提前配置了Mysql、Oracl、NoSQL等等与数据库相关的蓝图。
例如：可以通过以下步骤选择蓝图自服务申请：
1.  进入「服务目录」，在“申请云资源”的卡片上点击「申请」，指定关联一个蓝图，点击「下一步」

2.  「基本信息」页面，填写：
 + 业务组                   部署所属业务组
 + 服务部署名称             部署名称（若业务组已设定服务部署命名规则，服务部署名称将按照规则自动生成，无需填写）
 +   项目                     部署所属项目
 +   所有者                   部署所有者
 
3. 填写相关申请参数，例如：资源池、私有网络、虚拟机配置、存储大小、节点数量等等信息。
4. 点击「保存」，确认无误后点击「提交」，等待部署完成。
