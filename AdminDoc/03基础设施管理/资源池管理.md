



**资源池管理**


基础设施管理员纳管私有云、公有云、混合云、容器、物理机以及主流网络资源，将各类资源进行池化形成资源池。

管理员分配资源池给业务组使用，实现对云平台资源的切分，可以指定资源池使用目标云平台的特定资源，例如：自定义"开发资源池"为开发资源池关联存储资源和网络资源等，通过资源池指定能够使用的资源配额，如允许部署的虚拟机总量，允许申请的vCPU总量、内存总量等。


#添加资源池

成功添加云平台之后，支持将云平台资源划分成一个或多个资源池，分配相应的资源额度给不同的业务组使用，资源池和业务组的关联关系,资源的共享情况分为三种：

1.  资源池仅分配给唯一的业务组

2.  资源池分配给所有的业务组，并且新增的业务组自动关联该资源池

3.  资源池共享给多个业务组

资源池的使用情况如图所示：


## 添加vSphere资源池 {#添加vSphere资源池}

您可以根据下面的步骤来添加vSphere资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「vSphere」，会出现创建资源池界面。按照表单逐步填写相关信息，保存即可

2.  在「基本信息」页面需填入以下内容：

 + 名称	资源池名称
 + 允许共享给多个业务组	
 > 勾选后，如果在下方业务组的选择项中如果选择全部业务组，即配置为全局共享资源池，新增的业务组将自动关联；如果选择多个业务组，则共享给多个业务组,不勾选，在下方业务组选择唯一业务组，则单独分配给唯一选定的业务组。
 + 资源标签	给资源池添加标签以区分不同的使用环境（可选）
 + 优先级	用于帮助指定资源池选择策略，数值越小，优先级越高
 + 云平台入口	选择哪个 vCenter 划分资源池。
 + 资源入口	选择使用 vCenter 下的哪个集群或主机（包含集群和不在集群中的物理主机）
 + 文件夹	选择用于存储的文件夹（可选）



 计算资源」页面显示基本资源入口信息，根据资源入口信息内容填入以下内容：

 + vCPU                     本资源池最大允许部署多少vCPU数
 + 内存（GB）               本资源池最大允许部署多少(GB)内存
 + 虚机数量                 本资源池最大允许部署多少虚拟机
 +  每台虚拟机允许快照数量   每台虚拟机允许快照的最大数量
 +  vSphere资源池            部署出来的虚拟机存放在vSphere哪个资源池
 +  宿主机选择策略           内存有限或存储优先存储                     
 +  存储                     选择虚拟机部署使用的存储以及存储配额（请根据实际情况配置合适大小的资源池，若资源太少则会影响后续部署）

「网络资源」，选择网络及IP分配方式（手工指定、IP池、DHCP）；若选择IP池，则需要在IP地址管理栏下选择对应的IP池。可给网络添加描述，在服务配置选择时，将显示描述信息，方便选择

5.  点击「保存」按钮，vSphere资源池成功创建

## 添加vSphere with NSX资源池 {#添加vSphereWithNsx资源池}

添加vSphere带NSX资源池的前提是需要在vSphere云平台中关联VMware NSX。

您可以根据下面的步骤来添加vSphere带NSX资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「vSphere」，会出现创建资源池界面。按照表单逐步填写相关信息，保存即可；

2.  在「基本信息」页面需填入以下内容：

 + 名称	资源池名称
 + 允许共享给多个业务组	勾选后，如果在下方业务组的选择项中如果选择全部业务组，即配置为全局共享资源池，新增的业务组将自动关联；如果选择多个业务组，则共享给多个业务组,不勾选，在下方业务组选择唯一业务组，则单独分配给唯一选定的业务组。
 + 资源标签	给资源池添加标签以区分不同的使用环境（可选）
 + 优先级	用于帮助指定资源池选择策略，数值越小，优先级越高

 + 云平台入口	选择哪个 vCenter 划分资源池。
 + 资源入口	选择使用 vCenter 下的哪个集群或主机（包含集群和不在集群中的物理主机）
 + 文件夹	选择文件夹（可选）
 + VMware NSX传输区域	用于配置NSX逻辑交换机，若不选择，在「网络资源」页面将不显示「NXS逻辑交换机」子页面

 「计算资源」页面：同上节的[vSphere资源池配置](#添加vsphere资源池)
  「网络资源」页面：


 + 网络资源	选择网络以及该网络的IP分配方式，支持手工指定、IP池、DHCP，若选择IP池的分配方式需指定IP池。可给网络添加描述，在服务配置选择时，将显示描述信息，方便选择
 + 分布式虚拟交换机机	选择虚拟交换机
 + NSX逻辑交换机	选择逻辑交换机以及对应的IP池
 + NSX逻辑路由器	选择NSX逻辑路由器
 + NSX服务网关	选择NSX服务网关
 + NSX安全策略组	选择应用于该资源池的安全策略组

>「Note」网络资源和NSX逻辑交换机至少配置一种

5.  点击「保存」按钮，vSphere with NSX资源池成功创建

## 添加openStack资源池 {#添加openStack资源池}

您可以根据下面的步骤来添加openStack资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「openStack」

2.  在「基本信息」页面需填入以下信息：

 + 名称	资源池名称
 + 允许共享给多个业务组	勾选后，如果在下方业务组的选择项中如果选择全部业务组，即配置为全局共享资源池，新增的业务组将自动关联；如果选择多个业务组，则共享给多个业务组,不勾选，在下方业务组选择唯一业务组，则单独分配给唯一选定的业务组。
 + 资源标签	选择或输入自定义资源标签
 + 优先级	用于帮助指定资源池选择策略，数值越小，优先级越高

 + 云平台入口	选择哪个openStack划分资源池
 + 可用区	选择使用哪个可用区域DNS域	根据「系统管理」-「系统配置」中添加的DNS域，可选择为资源池添加一个或多个DNS域

>「Note」 DNS域需要都是租户DNS域名的子域名


3.  在「计算资源」页面显示基本资源信息，根据资源信息内容填入以下内容：

 +  vCPU         本资源池最大允许部署多少vCPU数
 + 内存（GB）   本资源池最大允许部署多少(GB)内存
 +  存储（GB）   本资源池最大允许部署多少(GB)存储
 +  虚机数量     本资源池最大允许部署多少虚拟机
 +  浮动IP数量   资源池最大预留浮动IP数量

>「Note」支持openStack的浮动IP单独部署，部署完成后可在「我的部署」-「云资源」-「网络资源」-「FloatingIP」中查看。若部署时候创建的FloatingIP数量超过资源池规定的FloatingIP数量时，会部署失败。

  在「网络资源」页面中有「网络资源」「安全策略组」「防火墙」三个标签页
-   「网络资源」：选择网络及对应的子网、IP分配方式（手工指定、IP池、DHCP）；若IP分配方式选择IP池，则需要指定IP池。可给网络添加描述，在服务配置选择时，将显示描述信息，方便选择

-   「安全策略组」：可选择一个或多个安全策略组

>「Note」网络资源和安全策略组必须配置

-   「防火墙」：可查看当前云平台下的防火墙名称、描述、策略、关联路由、状态（运行中、非激活），可选择一个或多个防火墙

 在「路由」界面可指定路由（选填）（若需要配置防火墙，则需要在此选择路由）

 点击「保存」按钮，openStack资源池成功创建

## 添加powerVC资源池 {#添加powerVC资源池}

您可以根据下面的步骤来添加powerVC资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「powerVC」

2.  在「基本信息」页面需填入以下内容：


 + 名称	资源池名称
 + 资源标签	选择或输入自定义标签
 + 优先级	用于帮助指定资源池选择策略，数值越小，优先级越高
 + 云平台入口	选择哪个openStack划分资源池
 + 可用区	选择使用哪个可用区域
 + 允许共享给多个业务组,业务组	勾选后，如果在下方业务组的选择项中如果选择全部业务组，即配置为全局共享资源池，新增的业务组将自动关联；如果选择多个业务组，则共享给多个业务组,不勾选，在下方业务组选择唯一业务组，则单独分配给唯一选定的业务组。


 在「计算资源」页面显示基本资源信息，根据资源信息内容填入以下内容：


 +  vCPU         本资源池最大允许部署多少vCPU数
 +   内存（GB）   本资源池最大允许部署多少(GB)内存
 +  存储（GB）   本资源池最大允许部署多少(GB)存储
 +   虚机数量     本资源池最大允许部署多少虚拟机

 在「网络资源」页：选择网络及对应的子网、IP分配方式（IP池、DHCP）；若选择IP池，则需要选择IP池。可给网络添加描述，在服务配置选择时，将显示描述信息，方便选择

  点击「保存」按钮，powerVC资源池成功创建

## 添加微软Hyper-V资源池 {#添加微软Hyper-V资源池}

您可以根据下面的步骤来添加Hyper-V资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「Hyper-V」，会出现创建资源池界面。按照表单逐步填写相关信息，保存即可

2.  在「基本信息」页面需填入以下内容：


 + 名称	资源池名称: HyperV资源池
 + 允许共享给多个业务组	勾选后，如果在下方业务组的选择项中如果选择全部业务组，即配置为全局共享资源池，新增的业务组将自动关联；如果选择多个业务组，则共享给多个业务组
 + 不勾选，在下方业务组选择唯一业务组，则单独分配给唯一选定的业务组。
 + 业务组	选择资源池所属的业务组
 + 资源标签	给资源池添加标签以区分不同的使用环境（可选）
 + 优先级	用于帮助指定资源池选择策略，数值越小，优先级越高

 + 云平台入口	选择创建的Hyper-V云平台。
 +  资源入口	选择使用哪个集群或主机（包含集群和不在集群中的物理主机）


3.  「计算资源」页面显示基本资源入口信息，根据资源入口信息内容填入以下内容：


 +  vCPU	本资源池最大允许部署多少vCPU数
 + 内存（GB）	本资源池最大允许部署多少(GB)内存
 + 虚机数量	本资源池最大允许部署多少虚拟机

 + 存储	选择虚拟机部署使用的存储以及存储配额（请根据实际情况配置合适大小的资源池，若资源太少则会影响后续部署）
 + 预留空间	勾选相应的群集共享卷CSV，填写预留空间


4.  「网络资源」，选择网络名称及IP分配方式（手工指定、DHCP）；可给网络添加描述，在服务配置选择时，将显示描述信息，方便选择

5.  点击「保存」按钮，Hyper-V资源池成功创建

## 添加物理服务器资源池 {#添加物理服务器资源池}

您可以根据下面的步骤来添加物理服务器资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「物理服务器」

2.  在「基本信息」页需填入资源池名称、资源标签（选填）、云平台入口、优先级等属性

3.  在「物理主机」页选中物理机，将选中的物理机导入x86云平台的资源池

4.  点击「保存」按钮，物理服务器资源池成功创建

## 添加Kubernetes资源池 {#添加Kubernetes资源池}

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「Kubernetes」

2.  在「基本信息」页填入资源池名称、资源标签（选填）、云平台入口、命名空间以及优先级

3.  在计算资源界面填入POD数量

4.  点击「保存」，Kubernetes资源池创建成功

## 添加Docker资源池 {#添加Docker资源池}

您可以根据下面的步骤来添加Docker资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「Docker」

2.  在「基本信息」页需填入资源池名称、资源标签（选填）、云平台入口、容器数量上限（选填）和优先级等属性

3.  在「主机列表」页显示主机的相关信息，如名称、操作系统、架构、服务端版本、CPU数量、内存等

4.  点击「保存」，Docker资源池创建成功

## 添加NFS资源池 {#添加NFS资源池}

您可以根据下面的步骤来添加NFS资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「NFS」

2.  在「基本信息」页面填入资源池名称、资源标签（选填）、
    云平台入口、优先级

3.  在「共享文件夹」标签页可添加若干NFS的共享目录

4.  点击「保存」，NFS资源池创建成功

## 添加阿里云资源池 {#添加阿里云资源池}

您可以根据下面的步骤来添加阿里云资源池:

7.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「阿里云」

8.  在「基本信息」页需填写资源池名称，资源标签（选填），云平台入口、网络类型（经典网络和专有网络）和优先级；网络类型为专有网络时，还需要从列表中选择一个专有网络

9.  在「计算资源」填入vCPU数量（上限），内存（上限），虚拟机数量（上限）

10. 在「网络资源」页选择可用的阿里云安全策略组；若网络类型为专有网络时，还需选择虚拟交换机

11. 点击「保存」，阿里云资源池创建成功

## 添加腾讯云资源池 {#添加腾讯云资源池}

您可以根据下面的步骤来添加腾讯云资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「腾讯云」

2.  在「基本信息」页需填写资源池名称、资源标签（选填）、云平台入口、优先级

3.  在「计算资源」页填入vCPU数量，内存大小和虚机数量

4.  在「网络资源」页，则可以选择相应的安全组

5.  点击「保存」，腾讯云资源池创建成功

## 添加青云资源池 {#添加青云资源池}

您可以根据下面的步骤来添加青云资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「青云」

2.  在「「基本信息」页需填入资源池名称、资源标签（选填）、云平台入口、优先级

3.  在「计算资源」页填入vCPU数量，内存大小和虚机数量

4.  在「防火墙」页面，选择一个防火墙策略

5.  点击「保存」，青云资源池创建成功

## 添加AWS资源池 {#添加AWS资源池}

您可以根据下面的步骤来添加AWS资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「AWS」

2.  在「基本信息」页需填入资源池名称、资源标签（选填）、优先级、云平台入口、区域、VPC网络

3.  在「计算资源」填入vCPU数量（上限）、内存（上限）、虚拟机数量（上限）

4.  在「网络资源」页，选择子网和安全策略组

5.  点击「保存」，AWS资源池创建成功

## 添加F5 Big IP资源池 {#添加F5BigIP资源池}

您可以根据下面的步骤来添加F5 BIG-IP资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「F5
    BIG-IP」

2.  在「基本信息」页需填入资源池名称、业务组、资源标签（选填）、云平台入口、IP池和允许共享给多个业务组

>「Note」关联业务组与资源池的共享状态，请参考：[业务组添加资源池](https://cloudchef.github.io/doc/AdminDoc/04组织架构管理/业务组.html#业务组添加资源池)

3.  点击「保存」，F5 BIG-IP资源池创建成功

>「Note」F5 Big
IP资源池需要关联IP池，才可以保存生效。如果当前没有对应的F5 Big
IP的IP池，需要先添加相应的IP池来完成资源池的创建，请您参考[添加IP池](https://cloudchef.github.io/doc/AdminDoc/03基础设施管理/IP地址管理.html#添加IP池)。

## 添加CISCO ACI资源池 {#添加CISCOACI资源池}

您可以根据下面的步骤来添加CISCO ACI资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「CISCO
    ACI」

2.  在「基本信息」页需填入资源池名称、资源标签（选填）、云平台入口、优先级

3.  在「网络资源」中选择应用策略

4.  点击「保存」，ACI资源池创建成功

## 添加Azure资源池 {#添加Azure资源池}

您可以根据下面的步骤来添加Azure资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」。点击「添加」按钮，选择「Azure」

2.  在「基本信息」页，包括「基本信息」和「云平台资源信息」两部分。「基本信息」需填写资源池名称，资源标签（选填）和优先级；若勾选「允许共享给多个业务组」，则此资源池可供多个业务组使用。「云平台资源信息」需选择云平台入口、输入订阅ID、选择区域、资源组和虚拟网络

3.  在「计算资源」页，填入vCPU数量（上限），内存（上限），虚拟机数量（上限）

4.  在「网络资源」页，包括「子网」「安全策略组」标签页

-   在「子网」页，选择子网及IP分配方式（手工指定、IP池、DHCP），通过手工指定和IP池方式可以分配内部专用IP地址。若选择IP池，则需要在IP池管理栏下选择对应的IP池

-   在「安全策略组」页，选择一个安全策略组

1.  在「存储资源」页，选择一项存储账户

2.  点击「保存」，Azure资源池创建成功

# 查看当前租户资源池

您可以根据下面的步骤来查看资源池:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」，将显示资源池列表界面。该列表显示当前已添加的资源池基本信息：资源池名称、类型、云平台入口、业务组、优先级、创建者、创建时间、已分配vCPU、已分配内存、已分配存储、已分配虚机数量

2.  点击资源池名称，进入资源池页面

3.  点击「资源使用趋势」菜单，该页面通过图表的形式直观地展示资源池使用情况，包括CPU使用情况、内存使用情况、存储使用情况，以及虚机使用数量。可通过调节时间跨度查看不同时间段的资源使用趋势情况，如1天、7天、15天、30天、90天、6个月、1年等

根据用户角色权限的不同，可进行的操作也不相同：

租户管理员和基础设施管理员可以编辑修改资源池信息；

业务组管理员可以查看资源池配额信息，并可提交扩容申请,操作步骤：

1.  在资源列表界面，点击资源池名称，进入资源池编辑界面

2.  点击左上角的「申请扩容」，填写资源扩容细节：如希望扩容的CPU、内存、存储的细节等

3.  点击「提交」，提示申请扩容成功。等待扩容申请审批回复。可在「服务审批」-「我的申请」中查看申请流程走向

# 资源池导入虚拟机

您可以根据下面的步骤来添导入虚拟机:

1.  在左边导航选择「基础设施」，选择二级菜单「资源池管理」

2.  点击资源池名称或选中某一资源池点击「编辑」，进入资源池编辑界面

3.  点击「云资源」标签，点击「导入」按钮，导入页面，可根据业务组、项目、所有者、标签进行筛选。也可选择一个集群，选择想要导入的虚拟机。点击「导入」即可

4.  导入的虚拟机可在「我的部署」-「云主机」中查看，可通过云主机列表中状态栏下的图标区分­

>「Note」资源池需要和业务组绑定后才可以进虚拟机导入。

# 资源池同步策略

您可以在资源池中设置同步策略，定时同步云平台新增的资源。支持的同步对象如下：

-   AWS支持：云主机、块存储、对象存储、安全组

-   Azure支持：云主机、块存储、对象存储、安全组、负载均衡器、MySQL数据库、SQL数据库、Web应用

-   vSphere和openStack支持：云主机

进入导航栏「基础设施」-「资源池管理」- 选择资源池 -
「同步策略」标签页，可对同步策略进行添加、编辑、删除、启用和禁用等操作。您可以根据下面的步骤设置资源池同步策略：

1.  点击「添加」，进入同步策略配置界面

2.  选择同步对象类型：点击对象类型即可选中，再次点击则取消选中

3.  输入同步策略名称

4.  选择业务组与资源池的关联情况，请参考：[业务组与资源池](https://cloudchef.github.io/doc/AdminDoc/04组织架构管理/业务组.html#业务组添加资源池)

5.  若该业务组下有多个项目，选择项目

6.  选择所有者

7.  过滤方式：通过"标签"和"基于名字的正则表达式"筛选出云平台新增的资源

8.  状态：启用或禁用

9.  执行时间：使用Cron表达式设置同步策略的执行时间

10. 策略管理：启用、禁用；删除、修改同步策略

# 修改/删除资源池配置

在左边导航选择「基础设施」，选择二级菜单「资源池管理」。

编辑资源池：点击资源池名称或选中某一资源池点击「编辑」，则出现资源编辑界面，根据添加openStack资源池与添加vSphere资源池的参数列表说明修改已存在的资源池，修改完成后，点击「保存」。

删除资源池：选中某一资源池后点击「删除」，确认删除即可。

>「Note」资源池如果和业务组进行绑定，删除会失败。