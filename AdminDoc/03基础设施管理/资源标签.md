
**资源标签**

标签核心功能：为您管理的资源池、资源池中配置的资源、以及创建或导入的云资源设置资源标签，标明资源池和其他资源的不同用途和属性，从而在配置和申请服务、创建和导入云资源的时候进行选择。


# 配置资源标签

添加标签的具体步骤：点击左侧导航栏 基础设施 - 资源标签 ，管理员有配置标签和定义标签的参数的权限。

1. 概况标签页：
  - 名称: 一般配置中文，比如环境
  - 主键：只能输入英文和数字，比如env，作为标识位
  - 描述
  - 序号：指定资源标签的排列序号，数值小的排列靠前
  - 选择类型：单选/多选，指定在做筛选时同一标签多个值集的选择方式
  - 指定的资源类型：
      + 资源环境标签：用于标记资源池的不同用途和属性。在配置和申请服务时，可通过标签自动匹配和选择符合要求的资源池。
      + 存储资源标签：用于标记资源池中的不同存储资源（例如不同的存储类型或存储池）。在配置和申请服务时，可通过标签自动匹配和选择符合要求的存储资源。
      + 网络资源标签：用于标记资源池中的不同网络资源（例如不同的虚拟交换机或子网）。在配置和申请服务时，可通过标签自动匹配和选择符合要求的网络资源。
      + 云资源标签: 在部署和导入云主机、云资源时，为云主机、云资源设置标签。

  >「Note」同一个资源池可以设置多个标签，例如：可以给同一个vSphere资源池的存储或网络资源，分别选择不同的标签。

2. 值集标签页：例如：当key是环境，支持创建值value时，支持添加一个值集（例如：生产环境），也支持添加多个值集（例如：生产环境、测试环境、开发环境）并且每个值需要配置名称， 主键（可以用于命名规则），以及描述。 

3. 点击保存按钮，资源标签创建完成。


# 使用资源标签

资源标签创建完成后，可以将资源池、存储资源或网络资源与资源标签进行绑定，从而在服务配置与申请界面进行筛选来快速匹配资源；在部署、导入云主机或云资源以及在Day2运维操作时可设置云资源标签，在服务部署、云主机及云资源列表展示资源已设置的标签并通过标签为云主机、云资源分类和过滤。


1. 在资源池配置中绑定资源标签，具体操作步骤：
   
   点击左侧导航栏 基础设施 - 资源池管理 ，点击任意资源池
   + 在“概况”标签页中“基本信息”区域中的“资源标签”选择框中，选择“键值标签”。一个资源池能选择一个或多个key，针对每个key能选择一个或多个value。例如：vSphere资源池，key选定为"环境"，选择一个value“开发环境”或多个value“生产环境、测试环境、开发环境”。
   + 点击“存储资源”标签页，为任意存储类型选择一个已创建的存储标签
2. 在服务配置中使用资源标签：
   + 配置Instance节点的资源池，可供选择的资源池来源于“共享资源池、业务组绑定的资源池”，使用资源标签可在选择资源池时快速定位所需资源池。
     - 选择手工指定资源池的策略，然后根据选定的资源标签过滤，再进一步根据标签过滤的结果进行选择，选择是否允许在申请时修改或者在审批时修改。
     - 例如：vSphere云服务配置Instance组件，选择手工指定资源池的策略，选定拥有“开发环境”资源标签的资源池“vSphere开发资源池”。若勾选“允许修改”，则服务配置完成之后，在服务申请时，可再一次选择资源池；若勾选“允许修改”和“仅审批时可改”，则仅在审批时可以修改资源池。
     - 当管理员设置的资源标签存在多个key并且每个key有多个value时：例如，存在两个key，分别为 “环境、性能 ”。环境key下面设有三个value ，分别为“Pro，UAT，Dev”；性能key下设有三个value分别为 “高性能，中性能，一般性能”。为两个资源池（vSphere-dev资源池和vSphere-test资源池）绑定资源标签，vSphere-dev资源池有2个标签：Pro和高性能，vSphere-test资源池有2个标签：UAT和一般性能。则在为节点配置云资源、服务申请页面展示的时候，“环境”下只显示Pro和UAT，“性能”下只显示高性能和一般性能，任意选择其中一个资源标签的value之后，剩余的标签展示要根据第一个资源标签的value的选择进行动态调整。例如：首先选择资源标签的value - Pro，剩余的第二个标签只会出现“高性能”。以此类推，在更多key和更多value的应用场景中，选择逻辑也一致。
     >「Note」 选择“自动选择剩余容量最大、自动选择费用最低、平均分配” 的资源池选择策略，平台将根据策略自动分配，并且自动分配的时候，只能在按照标签过滤出来的资源池当中进行选择。更多服务配置信息请参考：[服务配置](http://CMP-PUBLIC-IP/help/AdminDoc/05服务建模/服务配置.html) 
   + 配置用户申请存储资源的方式，选择“基于标签选择”，系统将自动匹配符合条件的存储（系统盘、数据盘）进行分配。选择是否允许在申请时修改或者在审批时修改。
3. 在服务申请中使用资源标签：
   + 若在服务配置的申请字段配置或系统全局服务申请字段配置中已启用云资源标签申请字段，则用户在申请页面可选择管理员预设的云资源标签，每个标签由一个键值对组成，云资源标签将对部署下所有资源生效。
   + 若在服务配置中勾选资源池允许修改，则在申请页面，针对每个key，根据资源池中已经配置的资源标签，只展现资源池中已经使用的value。
   + 若在服务配置中勾选存储允许修改，则在申请页面，用户可以直接选择标签并定义磁盘大小。
4. 在导入云主机和Day2运维操作使用云资源标签：用户在导入云主机配置标签时可选择管理员预设的云资源标签；在服务部署、云资源、云主机运维操作时可设置云资源标签，从而在云主机与云资源列表使用云资源标签过滤。
   >「Note」管理员需在系统设置 - [界面配置](http://CMP-PUBLIC-IP/help/AdminDoc/09系统管理/#界面配置) 中启用云资源标签的申请字段配置。
    